<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Calculadora de Descanso (11h CLT)</title>
  <style>
    :root{
      --bg:#0b1020; --card:#121a33; --muted:#8590a6; --text:#e8ecf7; --accent:#4ea8ff; --ok:#00c853; --warn:#ffb300;
      --radius:18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: radial-gradient(1200px 800px at 20% 0%, #14204a 0%, var(--bg) 45%, #070b16 100%);
      color:var(--text);
    }
    .wrap{
      max-width: 820px; margin: 40px auto; padding: 0 16px;
    }
    header{margin-bottom:18px}
    h1{font-size: clamp(22px, 3.6vw, 34px); margin:0 0 6px}
    p.lead{color:var(--muted); margin:0 0 18px}
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border:1px solid rgba(255,255,255,.08); border-radius: var(--radius);
      box-shadow: 0 10px 30px rgba(0,0,0,.35); padding: 16px;
    }
    .grid{display:grid; gap:14px}
    @media (min-width:720px){ .grid{grid-template-columns: 1fr 200px} }
    label{display:block; font-size:14px; color:var(--muted); margin-bottom:6px}
    input[type="datetime-local"], input[type="number"]{
      width:100%; padding:12px 12px; border-radius:12px; border:1px solid rgba(255,255,255,.12);
      background:#0e1530; color:var(--text); outline:none; font-size:16px;
    }
    input::placeholder{color:#66708a}
    .hint{font-size:12.5px; color:var(--muted); margin-top:6px}
    .result{
      margin-top:14px; padding:14px; border-radius:14px; background:#0d1530; border:1px solid rgba(255,255,255,.08)
    }
    .result strong{font-size:18px}
    .row{display:flex; gap:10px; flex-wrap:wrap; margin-top:10px}
    button{
      cursor:pointer; border:1px solid rgba(255,255,255,.12); background:#0f1836; color:var(--text);
      padding:10px 14px; border-radius:12px; font-weight:600; transition:.15s transform ease, .15s background ease;
    }
    button:hover{transform: translateY(-1px); background:#11204d}
    .pill{
      display:inline-block; padding:6px 10px; border-radius:999px; font-size:12px; font-weight:700; letter-spacing:.2px;
      border:1px solid rgba(255,255,255,.1); background:#0e1735; color:var(--muted)
    }
    .good{color:var(--ok)}
    .warn{color:var(--warn)}
    details{
      margin-top:18px; border-top:1px dashed rgba(255,255,255,.15); padding-top:16px
    }
    summary{cursor:pointer; color:var(--accent); font-weight:600}
    .footer-note{color:var(--muted); font-size:12.5px; margin-top:16px}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Calculadora de Descanso • 11 horas</h1>
      <p class="lead">Informe a <b>data e hora de saída</b> do colaborador. O sistema calcula a
        <b>entrada mínima</b> após o descanso (padrão: 11h).</p>
    </header>

    <section class="card" aria-labelledby="calc-title">
      <h2 id="calc-title" style="margin:0 0 12px;font-size:18px;color:#cdd7f1;">Cálculo principal</h2>

      <div class="grid">
        <div>
          <label for="saida">Saída do colaborador (data e hora)</label>
          <input id="saida" type="datetime-local" step="60" placeholder="AAAA-MM-DDTHH:MM" />
          <div class="hint">Ex.: 2025-08-28T21:00</div>
        </div>

        <div>
          <label for="horas">Horas mínimas de descanso</label>
          <input id="horas" type="number" min="0" step="0.25" value="11" />
          <div class="hint">CLT art. 66 → mínimo 11h</div>
        </div>
      </div>

      <div class="result" aria-live="polite" id="resultado">
        <div class="pill">Entrada mínima após descanso</div>
        <div style="margin-top:6px">
          <strong id="entradaMinima">—</strong>
        </div>
        <div id="infoSpan" class="hint" style="margin-top:6px"></div>
        <div class="row">
          <button id="copiar">Copiar resultado</button>
          <button id="limpar">Limpar</button>
        </div>
      </div>

      <details>
        <summary>➕ Cálculo inverso (opcional): a partir da <u>entrada</u>, mostrar saída <u>máxima</u></summary>
        <div class="grid" style="margin-top:12px">
          <div>
            <label for="entrada">Próxima entrada (data e hora)</label>
            <input id="entrada" type="datetime-local" step="60" placeholder="AAAA-MM-DDTHH:MM" />
            <div class="hint">Ex.: 2025-08-29T08:00</div>
          </div>
          <div>
            <label for="horas2">Horas mínimas de descanso</label>
            <input id="horas2" type="number" min="0" step="0.25" value="11" />
          </div>
        </div>
        <div class="result" aria-live="polite" id="resultado2">
          <div class="pill">Saída máxima do dia anterior</div>
          <div style="margin-top:6px">
            <strong id="saidaMaxima">—</strong>
          </div>
          <div id="infoSpan2" class="hint" style="margin-top:6px"></div>
          <div class="row">
            <button id="copiar2">Copiar resultado</button>
          </div>
        </div>
      </details>

      <div class="footer-note">
        ⚖️ Referência legal: CLT art. 66 — mínimo de <b>11 horas consecutivas</b> de descanso entre jornadas.
        Este app é informativo e não substitui políticas internas ou acordo coletivo.
      </div>
    </section>
  </div>

  <script>
    const saidaEl = document.getElementById('saida');
    const horasEl = document.getElementById('horas');
    const entradaMinimaEl = document.getElementById('entradaMinima');
    const infoSpanEl = document.getElementById('infoSpan');
    const copiarBtn = document.getElementById('copiar');
    const limparBtn = document.getElementById('limpar');

    const entradaEl = document.getElementById('entrada');
    const horas2El = document.getElementById('horas2');
    const saidaMaximaEl = document.getElementById('saidaMaxima');
    const infoSpan2El = document.getElementById('infoSpan2');
    const copiar2Btn = document.getElementById('copiar2');

    function fmt(dt){
      if(!(dt instanceof Date) || isNaN(dt)) return '—';
      // usa a hora local do navegador em pt-BR
      return dt.toLocaleString('pt-BR', {
        weekday: 'short', year:'numeric', month:'2-digit', day:'2-digit',
        hour:'2-digit', minute:'2-digit'
      }).replace(',', ' •');
    }

    function addMinutes(date, minutes){
      return new Date(date.getTime() + minutes*60000);
    }
    function subMinutes(date, minutes){
      return new Date(date.getTime() - minutes*60000);
    }

    function calcularEntradaMinima(){
      const saidaStr = saidaEl.value;
      const horas = parseFloat(horasEl.value || '11');
      if(!saidaStr || isNaN(horas)) {
        entradaMinimaEl.textContent = '—';
        infoSpanEl.textContent = '';
        return;
      }
      const saida = new Date(saidaStr);
      if(isNaN(saida)) {
        entradaMinimaEl.textContent = 'Entrada inválida';
        infoSpanEl.textContent = '';
        return;
      }
      const minutos = Math.round(horas*60);
      const entradaMin = addMinutes(saida, minutos);
      entradaMinimaEl.textContent = fmt(entradaMin);
      const horasTxt = (Math.floor(horas) === horas) ? `${horas}h` : `${horas.toFixed(2)}h`;
      infoSpanEl.innerHTML = `Respeitando <span class="good">${horasTxt}</span> de descanso a partir de <b>${fmt(saida)}</b>.`;
    }

    function calcularSaidaMaxima(){
      const entradaStr = entradaEl.value;
      const horas = parseFloat(horas2El.value || '11');
      if(!entradaStr || isNaN(horas)) {
        saidaMaximaEl.textContent = '—';
        infoSpan2El.textContent = '';
        return;
      }
      const entrada = new Date(entradaStr);
      if(isNaN(entrada)) {
        saidaMaximaEl.textContent = 'Entrada inválida';
        infoSpan2El.textContent = '';
        return;
      }
      const minutos = Math.round(horas*60);
      const saidaMax = subMinutes(entrada, minutos);
      saidaMaximaEl.textContent = fmt(saidaMax);
      const horasTxt = (Math.floor(horas) === horas) ? `${horas}h` : `${horas.toFixed(2)}h`;
      infoSpan2El.innerHTML = `Para iniciar às <b>${fmt(entrada)}</b>, a saída anterior deve ser até <span class="good">${fmt(saidaMax)}</span> (mín. ${horasTxt} de descanso).`;
    }

    function copiarTexto(txt){
      if(!txt || txt === '—') return;
      if(navigator.clipboard && navigator.clipboard.writeText){
        navigator.clipboard.writeText(txt).then(()=> {
          toast('Copiado!');
        }).catch(()=>fallback());
      } else { fallback(); }
      function fallback(){
        const ta = document.createElement('textarea');
        ta.value = txt; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); document.body.removeChild(ta);
        toast('Copiado!');
      }
    }

    function toast(msg){
      const t = document.createElement('div');
      t.textContent = msg;
      t.style.position='fixed'; t.style.left='50%'; t.style.bottom='22px'; t.style.transform='translateX(-50%)';
      t.style.background='#0e1735'; t.style.border='1px solid rgba(255,255,255,.18)'; t.style.color='var(--text)';
      t.style.padding='10px 14px'; t.style.borderRadius='999px'; t.style.boxShadow='0 8px 24px rgba(0,0,0,.35)';
      t.style.zIndex='9999'; t.style.fontWeight='700'; t.style.letterSpacing='.3px';
      document.body.appendChild(t);
      setTimeout(()=>{ t.style.transition='opacity .25s ease'; t.style.opacity='0'; }, 1200);
      setTimeout(()=> t.remove(), 1500);
    }

    // eventos
    saidaEl.addEventListener('input', calcularEntradaMinima);
    horasEl.addEventListener('input', calcularEntradaMinima);
    entradaEl.addEventListener('input', calcularSaidaMaxima);
    horas2El.addEventListener('input', calcularSaidaMaxima);

    copiarBtn.addEventListener('click', ()=>{
      copiarTexto(entradaMinimaEl.textContent);
    });
    copiar2Btn.addEventListener('click', ()=>{
      copiarTexto(saidaMaximaEl.textContent);
    });
    limparBtn.addEventListener('click', ()=>{
      saidaEl.value = '';
      entradaMinimaEl.textContent = '—';
      infoSpanEl.textContent = '';
      saidaEl.focus();
    });

    // dica: pré-preenche a duração padrão se o user digitar só a hora
    // (mantemos vazio por padrão para evitar suposições)
  </script>
</body>
</html>
